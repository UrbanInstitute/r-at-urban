{
  "hash": "a6532979833472b36c97d8024650091f",
  "result": {
    "markdown": "---\noutput: \n  html_document:\n    css: styles.css\n    self_contained: FALSE  \n    code_folding: hide\n    toc: TRUE\n    toc_float: TRUE     \n---\n\n\n<link rel=\"stylesheet\" href=\"//fonts.googleapis.com/css?family=Lato\" />\n\n<div id=\"header\">\n![](images/urban-institute-logo.png)\n</div>\n\n\n\n\n\n## Urban Institute R Table Guide\n\nR is a powerful programming language for statistics, plotting, and analysis. An abundance of books and online training materials are available for R, but most overlook building programmatic and reproducible tables. This guide aims to outline the strengths and weaknesses of tools for creating tables in R. \n\nIf you have any questions about building tables in R, or more generally using R, please don't hesitate to reach out to Aaron Williams (awilliams@urban.org). \n\n**Note:** It is important to communicate with the Urban Institute COMMS department about publications. Presence in this document is not a guarantee that the tools or styles are ready for an Urban Institute publication. \n\n## Getting started\n\nThere are two important steps to building a useful table in R:\n\n1) Get the data frame into the correct shape. \n2) Decide on the output format. \n\nThe section \"Tidy Data\" addresses the first step by outlining `library(broom)` and `library(dplyr)`. Both are powerful tools whose use extends beyond making tables.  \n\nThe rest of this document is dedicated to outlining the strengths, weaknesses, uses, and methods of different tools for building tables in R. The following subsections link output formats to tools:\n\n### R Markdown\n\ntodo(aaron): add image\n\nR Markdown is one of the most powerful parts of R. It combines \"text chunks\", \"code chunks\", and \"output chunks\" to create [a range of documents](http://rmarkdown.rstudio.com/gallery.html) including .PDF, .html, Microsoft Word, websites, books, and more (this guide was built using R Markdown!). It is best for creating *entire* documents instead of pieces of larger documents. \n\nMost of the tools in this document are optimized for creating tables using R Markdown. This is fortunate if R Markdown is the tool of choice for a publication and unfortunate if R is just one piece of a heterogeneous workflow.  \n\n### html\n\nThis guide is an html document. Any table in this document can be easily replicated as-is in .html. `kable()`, `library(kableExtra)`, `library(formattable)`, and `library(stargazer)` are the best tools for .html documents. \n\nHere's an example .html table:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(formattable)\nlibrary(kableExtra)\n\ndiamonds %>%\n  top_n(5, price) %>%\n  arrange(desc(price)) %>%\n  select(Carat = carat, Cut = cut, Price = price) %>%\n  mutate(Price = currency(Price, digits = 0)) %>%\n  kable(caption = \"Top Diamond Prices\", align = \"r\", format = \"html\") %>%\n  kable_styling(full_width = FALSE, position = \"left\") %>%\n  add_footnote(\"Urban Institute analysis of diamond data\", notation = \"alphabet\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; \">\n<caption>Top Diamond Prices</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Carat </th>\n   <th style=\"text-align:right;\"> Cut </th>\n   <th style=\"text-align:right;\"> Price </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 2.29 </td>\n   <td style=\"text-align:right;\"> Premium </td>\n   <td style=\"text-align:right;\"> $18,823 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2.00 </td>\n   <td style=\"text-align:right;\"> Very Good </td>\n   <td style=\"text-align:right;\"> $18,818 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1.51 </td>\n   <td style=\"text-align:right;\"> Ideal </td>\n   <td style=\"text-align:right;\"> $18,806 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2.07 </td>\n   <td style=\"text-align:right;\"> Ideal </td>\n   <td style=\"text-align:right;\"> $18,804 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2.00 </td>\n   <td style=\"text-align:right;\"> Very Good </td>\n   <td style=\"text-align:right;\"> $18,803 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr>\n<td style = 'padding: 0; border:0;' colspan='100%'><sup>a</sup> Urban Institute analysis of diamond data</td>\n</tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n### PDF\n\nR Markdown is great for \"knitting\" straight to PDF. Many of the tables in this document can be \"knitted\" to PDF with little to no change to the code but the output will look a little different than .html. `kable()`, `library(kableExtra)`, `library(formattable)`, and `library(stargazer)` are the best tools for PDFs. \n\nHere's a great example of a PDF table by Bhargavi Ganesh (HFPC):\n\n![](images/ganesh.png)\n\ntodo(aaron): update Bhargavi example\n\n### LaTeX\n\nLaTeX (pronounced \"lay-tech\") is a syntax/micro-language for typesetting technical and scientific documents. `kable()`, `library(kableExtra)`, and `library(stargazer)` can all write to LaTeX which can then be implemented elsewhere.  \n\nHere's an example of raw LaTeX output by `kable()`:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/latex.png){width=500px}\n:::\n:::\n\n\n### Text\n\n`library(stargazer)` is the only real option for printing ASCII tables. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/ascii.png){width=500px}\n:::\n:::\n\n\n### Microsoft Word\n\nThe appealing but dense formatting of the Urban Institute's Microsoft Word template makes it effectively impossible right now to \"knit\" or write straight to Microsoft Word for publications. R Markdown and `library(WordR)` can both \"knit\" or write straight to Microsoft Word documents. \n\n### Microsoft Excel\n\nR tools for interacting with Microsoft Excel have never been more powerful. `library(readr)`, `library(writexl)`, and `library(openxlsx)` can write to .csv, .xls, .xlsx without formats, and .xlsx with formats. All three tools are outlined under \"Export to Excel\". \n\nIf Excel is necessary, programmatically write the data to one sheet in a workbook and then use cell references to build Urban Institute-compliant tables in another sheet. This way, the data can be updated without deleting the tables or formatting. \n\n![](images/borough.png)\n\n*An early table in \"A Discours of the Variation of the Cumpas, or Magneticall Needle\" by William Borough (1581)*\n\n## kable()\n\nThe `kable()` function from `library(knitr)` is the simplest way to build tables in R Markdown. \n\n`kable()`'s tables are ugly in the R console, but their default is appealing in R Markdown. Add `css: styles.css` to the R Markdown YAML header before using `kable()` so styles and fonts are Urban Institute compliant.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n---\noutput: \n  html_document:\n    css: styles.css\n---\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars_subset <- mtcars %>%\n\trownames_to_column(var = \"Model\") %>%\n\tselect(Model, MPG = mpg, Cylinders = cyl, Weight = wt) %>%\n\tarrange(-MPG) %>%\n\ttop_n(5, MPG)\n\nmtcars_subset %>%\n\tkable(caption = \"Cars with the best fuel economy\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Cars with the best fuel economy</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> MPG </th>\n   <th style=\"text-align:right;\"> Cylinders </th>\n   <th style=\"text-align:right;\"> Weight </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Toyota Corolla </td>\n   <td style=\"text-align:right;\"> 33.9 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.835 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Fiat 128 </td>\n   <td style=\"text-align:right;\"> 32.4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2.200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Honda Civic </td>\n   <td style=\"text-align:right;\"> 30.4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.615 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lotus Europa </td>\n   <td style=\"text-align:right;\"> 30.4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.513 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Fiat X1-9 </td>\n   <td style=\"text-align:right;\"> 27.3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.935 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### caption\n\n`caption =` adds a title to the R Markdown table. \n\nTitles can also be added with `##`, `###`, `####`, etc. in R Markdown documents. This is advantageous because the table title will be added to the table of contents based on where it falls in the hierarchy of html/R Markdown headers. R Markdown table titles default to the same size as headers with ####.\n\n`#### Cars with the best fuel economy`\n\n#### Cars with the best fuel economy\n\n### digits\n\n`digits =` controls the maximum number of digits for each number in a table. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars_subset %>%\n\tkable(digits = 0)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> MPG </th>\n   <th style=\"text-align:right;\"> Cylinders </th>\n   <th style=\"text-align:right;\"> Weight </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Toyota Corolla </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Fiat 128 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Honda Civic </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lotus Europa </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Fiat X1-9 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### col.names\n\nThe first `kable()` example in the `library(kable)` subsection renamed variables with `select()` before making the table. This is often necessary because lower case names with underscores are more common in analyses than Urban Institute-compliant column names (sentence case).\n\nAnother option is to specify a vector of column names when using `kable()`. `col.names =` specifies a vector with which to replace column names. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars_subset %>%\n\tkable(col.names = c(\"Car model\", \"Fuel Economy\", \"Cylinders\", \"Weight (Tons)\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Car model </th>\n   <th style=\"text-align:right;\"> Fuel Economy </th>\n   <th style=\"text-align:right;\"> Cylinders </th>\n   <th style=\"text-align:right;\"> Weight (Tons) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Toyota Corolla </td>\n   <td style=\"text-align:right;\"> 33.9 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.835 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Fiat 128 </td>\n   <td style=\"text-align:right;\"> 32.4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2.200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Honda Civic </td>\n   <td style=\"text-align:right;\"> 30.4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.615 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lotus Europa </td>\n   <td style=\"text-align:right;\"> 30.4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.513 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Fiat X1-9 </td>\n   <td style=\"text-align:right;\"> 27.3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.935 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### align\n\n`align =` changes the column alignment. Numeric columns are right-aligned by default and all other columns are left-aligned by default. \n\nOptions are `\"l\"`, `\"c\"`, and `\"r\"`. Individual columns can be formatted by combining options into one character string (ex. `\"rlrlc\"`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars_subset %>%\n\tselect(MPG, Cylinders, Weight, Model) %>%\n\tkable(align = \"rlrr\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> MPG </th>\n   <th style=\"text-align:left;\"> Cylinders </th>\n   <th style=\"text-align:right;\"> Weight </th>\n   <th style=\"text-align:right;\"> Model </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 33.9 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.835 </td>\n   <td style=\"text-align:right;\"> Toyota Corolla </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 32.4 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2.200 </td>\n   <td style=\"text-align:right;\"> Fiat 128 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 30.4 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.615 </td>\n   <td style=\"text-align:right;\"> Honda Civic </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 30.4 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.513 </td>\n   <td style=\"text-align:right;\"> Lotus Europa </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 27.3 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.935 </td>\n   <td style=\"text-align:right;\"> Fiat X1-9 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### additional arguments\n\n* `trim = FALSE`\n* `nsmall = 0L`\n* `justify = c(\"left\", \"right\", \"centre\", \"none\")`\n* `width = NULL`\n* `na.encode = TRUE`\n* `scientific = NA`\n* `big.mark   = \"\"`  \n* `big.interval = 3L`\n* `small.mark = \"\"`\n* `small.interval = 5L`\n* `decimal.mark = getOption(\"OutDec\")`\n* `zero.print = NULL`\n* `drop0trailing = FALSE, ...)`\n\n## library(kableExtra)\n\n`library(kableExtra)` extends the power and customization of `library(kable)`.\n\n[This article](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html) outlines many of the following capabilities. \n\n### full_width\n\n\"kables\" stretch to the full width of a document by default. `full_width = FALSE` turns off this default. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(kableExtra)\n\nkable(x = head(mtcars), format = \"html\") %>%\n  kable_styling(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> mpg </th>\n   <th style=\"text-align:right;\"> cyl </th>\n   <th style=\"text-align:right;\"> disp </th>\n   <th style=\"text-align:right;\"> hp </th>\n   <th style=\"text-align:right;\"> drat </th>\n   <th style=\"text-align:right;\"> wt </th>\n   <th style=\"text-align:right;\"> qsec </th>\n   <th style=\"text-align:right;\"> vs </th>\n   <th style=\"text-align:right;\"> am </th>\n   <th style=\"text-align:right;\"> gear </th>\n   <th style=\"text-align:right;\"> carb </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.620 </td>\n   <td style=\"text-align:right;\"> 16.46 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 Wag </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.875 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Datsun 710 </td>\n   <td style=\"text-align:right;\"> 22.8 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 108 </td>\n   <td style=\"text-align:right;\"> 93 </td>\n   <td style=\"text-align:right;\"> 3.85 </td>\n   <td style=\"text-align:right;\"> 2.320 </td>\n   <td style=\"text-align:right;\"> 18.61 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet 4 Drive </td>\n   <td style=\"text-align:right;\"> 21.4 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 258 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.08 </td>\n   <td style=\"text-align:right;\"> 3.215 </td>\n   <td style=\"text-align:right;\"> 19.44 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet Sportabout </td>\n   <td style=\"text-align:right;\"> 18.7 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 360 </td>\n   <td style=\"text-align:right;\"> 175 </td>\n   <td style=\"text-align:right;\"> 3.15 </td>\n   <td style=\"text-align:right;\"> 3.440 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Valiant </td>\n   <td style=\"text-align:right;\"> 18.1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 225 </td>\n   <td style=\"text-align:right;\"> 105 </td>\n   <td style=\"text-align:right;\"> 2.76 </td>\n   <td style=\"text-align:right;\"> 3.460 </td>\n   <td style=\"text-align:right;\"> 20.22 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### position\n\nUsing `full_width = F` opens up the possibility of changing the alignment of the table on the page. \n\nFor example, `position = \"left\"`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(x = head(mtcars), format = \"html\", caption = \"mtcars with position = 'left'\") %>%\n  kable_styling(full_width = FALSE, position = \"left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; \">\n<caption>mtcars with position = 'left'</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> mpg </th>\n   <th style=\"text-align:right;\"> cyl </th>\n   <th style=\"text-align:right;\"> disp </th>\n   <th style=\"text-align:right;\"> hp </th>\n   <th style=\"text-align:right;\"> drat </th>\n   <th style=\"text-align:right;\"> wt </th>\n   <th style=\"text-align:right;\"> qsec </th>\n   <th style=\"text-align:right;\"> vs </th>\n   <th style=\"text-align:right;\"> am </th>\n   <th style=\"text-align:right;\"> gear </th>\n   <th style=\"text-align:right;\"> carb </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.620 </td>\n   <td style=\"text-align:right;\"> 16.46 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 Wag </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.875 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Datsun 710 </td>\n   <td style=\"text-align:right;\"> 22.8 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 108 </td>\n   <td style=\"text-align:right;\"> 93 </td>\n   <td style=\"text-align:right;\"> 3.85 </td>\n   <td style=\"text-align:right;\"> 2.320 </td>\n   <td style=\"text-align:right;\"> 18.61 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet 4 Drive </td>\n   <td style=\"text-align:right;\"> 21.4 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 258 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.08 </td>\n   <td style=\"text-align:right;\"> 3.215 </td>\n   <td style=\"text-align:right;\"> 19.44 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet Sportabout </td>\n   <td style=\"text-align:right;\"> 18.7 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 360 </td>\n   <td style=\"text-align:right;\"> 175 </td>\n   <td style=\"text-align:right;\"> 3.15 </td>\n   <td style=\"text-align:right;\"> 3.440 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Valiant </td>\n   <td style=\"text-align:right;\"> 18.1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 225 </td>\n   <td style=\"text-align:right;\"> 105 </td>\n   <td style=\"text-align:right;\"> 2.76 </td>\n   <td style=\"text-align:right;\"> 3.460 </td>\n   <td style=\"text-align:right;\"> 20.22 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### mtcars with float_right\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(x = head(mtcars), format = \"html\") %>%\n  kable_styling(full_width = FALSE, position = \"float_right\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; float: right; margin-left: 10px;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> mpg </th>\n   <th style=\"text-align:right;\"> cyl </th>\n   <th style=\"text-align:right;\"> disp </th>\n   <th style=\"text-align:right;\"> hp </th>\n   <th style=\"text-align:right;\"> drat </th>\n   <th style=\"text-align:right;\"> wt </th>\n   <th style=\"text-align:right;\"> qsec </th>\n   <th style=\"text-align:right;\"> vs </th>\n   <th style=\"text-align:right;\"> am </th>\n   <th style=\"text-align:right;\"> gear </th>\n   <th style=\"text-align:right;\"> carb </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.620 </td>\n   <td style=\"text-align:right;\"> 16.46 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 Wag </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.875 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Datsun 710 </td>\n   <td style=\"text-align:right;\"> 22.8 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 108 </td>\n   <td style=\"text-align:right;\"> 93 </td>\n   <td style=\"text-align:right;\"> 3.85 </td>\n   <td style=\"text-align:right;\"> 2.320 </td>\n   <td style=\"text-align:right;\"> 18.61 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet 4 Drive </td>\n   <td style=\"text-align:right;\"> 21.4 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 258 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.08 </td>\n   <td style=\"text-align:right;\"> 3.215 </td>\n   <td style=\"text-align:right;\"> 19.44 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet Sportabout </td>\n   <td style=\"text-align:right;\"> 18.7 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 360 </td>\n   <td style=\"text-align:right;\"> 175 </td>\n   <td style=\"text-align:right;\"> 3.15 </td>\n   <td style=\"text-align:right;\"> 3.440 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Valiant </td>\n   <td style=\"text-align:right;\"> 18.1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 225 </td>\n   <td style=\"text-align:right;\"> 105 </td>\n   <td style=\"text-align:right;\"> 2.76 </td>\n   <td style=\"text-align:right;\"> 3.460 </td>\n   <td style=\"text-align:right;\"> 20.22 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nBody text can be set to the side of a table using `float_right` or `float_left`. The text that appears next to the table goes after the function call in R Markdown documents. \n\n### column_spec\n\nIndividual columns can be formatted with `column_spec()`. The arguments are `width`, `bold`, `italic`, `monospace`, `color` (text color), `background` (column color), `border_left`, and `border_right`. If the paragraph next to a table with `position = \"float_right\"` is too short, the head and text of the subsequent section will appear next to the table. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(x = head(mtcars), format = \"html\", caption = \"Highlight an important column\") %>%\n  kable_styling(full_width = FALSE) %>%\n\tcolumn_spec(3, background = \"#1696d2\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Highlight an important column</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> mpg </th>\n   <th style=\"text-align:right;\"> cyl </th>\n   <th style=\"text-align:right;\"> disp </th>\n   <th style=\"text-align:right;\"> hp </th>\n   <th style=\"text-align:right;\"> drat </th>\n   <th style=\"text-align:right;\"> wt </th>\n   <th style=\"text-align:right;\"> qsec </th>\n   <th style=\"text-align:right;\"> vs </th>\n   <th style=\"text-align:right;\"> am </th>\n   <th style=\"text-align:right;\"> gear </th>\n   <th style=\"text-align:right;\"> carb </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;background-color: #1696d2 !important;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.620 </td>\n   <td style=\"text-align:right;\"> 16.46 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 Wag </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;background-color: #1696d2 !important;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.875 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Datsun 710 </td>\n   <td style=\"text-align:right;\"> 22.8 </td>\n   <td style=\"text-align:right;background-color: #1696d2 !important;\"> 4 </td>\n   <td style=\"text-align:right;\"> 108 </td>\n   <td style=\"text-align:right;\"> 93 </td>\n   <td style=\"text-align:right;\"> 3.85 </td>\n   <td style=\"text-align:right;\"> 2.320 </td>\n   <td style=\"text-align:right;\"> 18.61 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet 4 Drive </td>\n   <td style=\"text-align:right;\"> 21.4 </td>\n   <td style=\"text-align:right;background-color: #1696d2 !important;\"> 6 </td>\n   <td style=\"text-align:right;\"> 258 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.08 </td>\n   <td style=\"text-align:right;\"> 3.215 </td>\n   <td style=\"text-align:right;\"> 19.44 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet Sportabout </td>\n   <td style=\"text-align:right;\"> 18.7 </td>\n   <td style=\"text-align:right;background-color: #1696d2 !important;\"> 8 </td>\n   <td style=\"text-align:right;\"> 360 </td>\n   <td style=\"text-align:right;\"> 175 </td>\n   <td style=\"text-align:right;\"> 3.15 </td>\n   <td style=\"text-align:right;\"> 3.440 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Valiant </td>\n   <td style=\"text-align:right;\"> 18.1 </td>\n   <td style=\"text-align:right;background-color: #1696d2 !important;\"> 6 </td>\n   <td style=\"text-align:right;\"> 225 </td>\n   <td style=\"text-align:right;\"> 105 </td>\n   <td style=\"text-align:right;\"> 2.76 </td>\n   <td style=\"text-align:right;\"> 3.460 </td>\n   <td style=\"text-align:right;\"> 20.22 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### row_spec\n\nIndividual rows can be formatted with `row_spec()`. The arguments are `bold`, `italic`, `monospace`, `color` (text color), and `background` (row color). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(x = head(mtcars), format = \"html\", caption = \"Highlight an important row\") %>%\n  kable_styling(full_width = FALSE, position = \"left\") %>%\n\trow_spec(3, color = \"#ffffff\", background = \"#1696d2\", bold = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; \">\n<caption>Highlight an important row</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> mpg </th>\n   <th style=\"text-align:right;\"> cyl </th>\n   <th style=\"text-align:right;\"> disp </th>\n   <th style=\"text-align:right;\"> hp </th>\n   <th style=\"text-align:right;\"> drat </th>\n   <th style=\"text-align:right;\"> wt </th>\n   <th style=\"text-align:right;\"> qsec </th>\n   <th style=\"text-align:right;\"> vs </th>\n   <th style=\"text-align:right;\"> am </th>\n   <th style=\"text-align:right;\"> gear </th>\n   <th style=\"text-align:right;\"> carb </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.620 </td>\n   <td style=\"text-align:right;\"> 16.46 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mazda RX4 Wag </td>\n   <td style=\"text-align:right;\"> 21.0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n   <td style=\"text-align:right;\"> 2.875 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> Datsun 710 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 22.8 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 4 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 108 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 93 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 3.85 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 2.320 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 18.61 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 1 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 1 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 4 </td>\n   <td style=\"text-align:right;font-weight: bold;color: #ffffff !important;background-color: #1696d2 !important;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet 4 Drive </td>\n   <td style=\"text-align:right;\"> 21.4 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 258 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 3.08 </td>\n   <td style=\"text-align:right;\"> 3.215 </td>\n   <td style=\"text-align:right;\"> 19.44 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hornet Sportabout </td>\n   <td style=\"text-align:right;\"> 18.7 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 360 </td>\n   <td style=\"text-align:right;\"> 175 </td>\n   <td style=\"text-align:right;\"> 3.15 </td>\n   <td style=\"text-align:right;\"> 3.440 </td>\n   <td style=\"text-align:right;\"> 17.02 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Valiant </td>\n   <td style=\"text-align:right;\"> 18.1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 225 </td>\n   <td style=\"text-align:right;\"> 105 </td>\n   <td style=\"text-align:right;\"> 2.76 </td>\n   <td style=\"text-align:right;\"> 3.460 </td>\n   <td style=\"text-align:right;\"> 20.22 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### add_header_above\n\n`library(kableExtra)` can add a second tier of column labels with `add_header_above`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiamonds %>%\n\tfilter(row_number() < 10) %>%\n\tselect(price, carat, cut, color, clarity) %>%\n\tkable(format = \"html\", caption = \"Diamond features\") %>%\n  kable_styling(full_width = FALSE) %>%\n\tadd_header_above(c(\" \" = 1, \"Shape and size\" = 2, \"Stone color\" = 2))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Diamond features</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Shape and size</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Stone color</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:right;\"> price </th>\n   <th style=\"text-align:right;\"> carat </th>\n   <th style=\"text-align:left;\"> cut </th>\n   <th style=\"text-align:left;\"> color </th>\n   <th style=\"text-align:left;\"> clarity </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 326 </td>\n   <td style=\"text-align:right;\"> 0.23 </td>\n   <td style=\"text-align:left;\"> Ideal </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:left;\"> SI2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 326 </td>\n   <td style=\"text-align:right;\"> 0.21 </td>\n   <td style=\"text-align:left;\"> Premium </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:left;\"> SI1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 327 </td>\n   <td style=\"text-align:right;\"> 0.23 </td>\n   <td style=\"text-align:left;\"> Good </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:left;\"> VS1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 334 </td>\n   <td style=\"text-align:right;\"> 0.29 </td>\n   <td style=\"text-align:left;\"> Premium </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:left;\"> VS2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 335 </td>\n   <td style=\"text-align:right;\"> 0.31 </td>\n   <td style=\"text-align:left;\"> Good </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:left;\"> SI2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 336 </td>\n   <td style=\"text-align:right;\"> 0.24 </td>\n   <td style=\"text-align:left;\"> Very Good </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:left;\"> VVS2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 336 </td>\n   <td style=\"text-align:right;\"> 0.24 </td>\n   <td style=\"text-align:left;\"> Very Good </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:left;\"> VVS1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 337 </td>\n   <td style=\"text-align:right;\"> 0.26 </td>\n   <td style=\"text-align:left;\"> Very Good </td>\n   <td style=\"text-align:left;\"> H </td>\n   <td style=\"text-align:left;\"> SI1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 337 </td>\n   <td style=\"text-align:right;\"> 0.22 </td>\n   <td style=\"text-align:left;\"> Fair </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:left;\"> VS2 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### group_rows\n  \nSimilarly, `group_rows()` can be used to add an extra tier of row labels. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiamonds %>%\n\tfilter(cut %in% c(\"Ideal\", \"Premium\")) %>%\n\tfilter(row_number() <= 10) %>%\n\tarrange(cut, desc(price)) %>%\n\tselect(carat, color, price) %>%\n\tkable(format = \"html\", caption = \"Diamond prices\") %>%\n\tkable_styling(full_width = FALSE) %>%\n  group_rows(\"Premium\", 1, 6) %>%\n  group_rows(\"Ideal\", 7, 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Diamond prices</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> carat </th>\n   <th style=\"text-align:left;\"> color </th>\n   <th style=\"text-align:right;\"> price </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"6\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Premium</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.24 </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:right;\"> 355 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.20 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 345 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.32 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 345 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.22 </td>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 342 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.29 </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:right;\"> 334 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.21 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 326 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Ideal</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.30 </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:right;\"> 348 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.31 </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:right;\"> 344 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.23 </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:right;\"> 340 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.23 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 326 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### add_footnote()\n\nAdding footnotes to tables is simple with `add_footnote()`. `notation =` can be set to \"number\", \"alphabet\", or \"symbol\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiamonds %>%\n\tfilter(cut %in% c(\"Ideal\", \"Premium\")) %>%\n\tfilter(row_number() <= 10) %>%\n\tarrange(cut, desc(price)) %>%\n\tselect(carat, color, price) %>%\n\tkable(format = \"html\", caption = \"Diamond prices\") %>%\n\tkable_styling(full_width = FALSE) %>%\n  group_rows(\"Premium\", 1, 6) %>%\n  group_rows(\"Ideal\", 7, 10) %>%\n\tadd_footnote(c(\"All prices are in 2017 dollars\", \"Urban Institute analysis of diamond data\"), notation = \"alphabet\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Diamond prices</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> carat </th>\n   <th style=\"text-align:left;\"> color </th>\n   <th style=\"text-align:right;\"> price </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"6\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Premium</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.24 </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:right;\"> 355 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.20 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 345 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.32 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 345 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.22 </td>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 342 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.29 </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:right;\"> 334 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.21 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 326 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Ideal</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.30 </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:right;\"> 348 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.31 </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:right;\"> 344 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.23 </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:right;\"> 340 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.23 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 326 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr>\n<td style = 'padding: 0; border:0;' colspan='100%'><sup>a</sup> All prices are in 2017 dollars</td>\n</tr>\n<tr>\n<td style = 'padding: 0; border:0;' colspan='100%'><sup>b</sup> Urban Institute analysis of diamond data</td>\n</tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n  \nFootnotes can also reference titles and column headings.   \n  \n\n::: {.cell}\n\n```{.r .cell-code}\ndiamonds %>%\n\tfilter(cut %in% c(\"Ideal\", \"Premium\")) %>%\n\tfilter(row_number() <= 10) %>%\n\tarrange(cut, desc(price)) %>%\n\tselect(carat, color, price) %>%\n\tkable(format = \"html\", caption = \"Diamond prices[note]\") %>%\n\tkable_styling(full_width = FALSE) %>%\n  group_rows(\"Premium [note]\", 1, 6) %>%\n  group_rows(\"Ideal\", 7, 10) %>%\n\tadd_footnote(c(\"Could include blood diamonds\", \"All prices are in 2017 dollars\", \"Urban Institute analysis of diamond data\"), notation = \"alphabet\") \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Diamond prices<sup>a</sup></caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> carat </th>\n   <th style=\"text-align:left;\"> color </th>\n   <th style=\"text-align:right;\"> price </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"6\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Premium <sup>b</sup></strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.24 </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:right;\"> 355 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.20 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 345 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.32 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 345 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.22 </td>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 342 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.29 </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:right;\"> 334 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.21 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 326 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Ideal</strong></td></tr>\n<tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.30 </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:right;\"> 348 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.31 </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:right;\"> 344 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.23 </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:right;\"> 340 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;padding-left: 2em;\" indentlevel=\"1\"> 0.23 </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 326 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr>\n<td style = 'padding: 0; border:0;' colspan='100%'><sup>a</sup> Could include blood diamonds</td>\n</tr>\n<tr>\n<td style = 'padding: 0; border:0;' colspan='100%'><sup>b</sup> All prices are in 2017 dollars</td>\n</tr>\n<tr>\n<td style = 'padding: 0; border:0;' colspan='100%'><sup>c</sup> Urban Institute analysis of diamond data</td>\n</tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n## library(formattable)\n\n`library(formattable)` has two distinct applications. The first is formatting vectors that can be used in any table or output in R. The second is building highly-formatted tables that go beyond `library(kable)` + `library(kableExtra)`. \n\n### Pre-defined Formats\n\nPercentages are usually stored as decimals in R for ease of computation. But it is often desirable to present those decimals as percentages in tables. The function `percent()` quickly converts a vector of decimals like `0.068` into percentages like `6.8%`. The argument `digits =` controls the number of decimal places to be shown.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(formattable)\n\nunemployment <- tibble(\n\tState = c(\"Alabama\", \"Alaska\", \"Arizona\", \"Arkansas\", \"California\"),\n  `2000` = percent(c(.068, .05, .05, .04, .09), digits = 1),\n  `2013` = percent(c(.064, .062, .05, .06, .065), digits = 1),\n  Change = percent(c(-.004, .012, 0, .02, -.025), digits = 1)\n\t)\n\nformattable(unemployment)\n```\n\n::: {.cell-output-display}\n<table class=\"table table-condensed\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> State </th>\n   <th style=\"text-align:right;\"> 2000 </th>\n   <th style=\"text-align:right;\"> 2013 </th>\n   <th style=\"text-align:right;\"> Change </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> Alabama </td>\n   <td style=\"text-align:right;\"> 6.8% </td>\n   <td style=\"text-align:right;\"> 6.4% </td>\n   <td style=\"text-align:right;\"> -0.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> Alaska </td>\n   <td style=\"text-align:right;\"> 5.0% </td>\n   <td style=\"text-align:right;\"> 6.2% </td>\n   <td style=\"text-align:right;\"> 1.2% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> Arizona </td>\n   <td style=\"text-align:right;\"> 5.0% </td>\n   <td style=\"text-align:right;\"> 5.0% </td>\n   <td style=\"text-align:right;\"> 0.0% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> Arkansas </td>\n   <td style=\"text-align:right;\"> 4.0% </td>\n   <td style=\"text-align:right;\"> 6.0% </td>\n   <td style=\"text-align:right;\"> 2.0% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> California </td>\n   <td style=\"text-align:right;\"> 9.0% </td>\n   <td style=\"text-align:right;\"> 6.5% </td>\n   <td style=\"text-align:right;\"> -2.5% </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n\n\n`library(formattable)` comes with useful pre-defined formats for `percent()`, `comma()`, `currency()`, `accounting()`, and `scientific()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformats <- tibble(\n  Percent = percent(c(.068, .05, .05, .04, .09), digits = 1),\n\tComma = comma(c(1000, 10000, 100000, 1000000, 10000000), digits = 0),\n\tCurrency = currency(c(1, 1, 1, 1, 1)),\n\tAccounting = accounting(c(1, 1, 1, 1, 1)),\n\tScientific = scientific(c(0.0001, 100000, 100000000000, 1, 1))\n)\n\t\nformattable(formats)\n```\n\n::: {.cell-output-display}\n<table class=\"table table-condensed\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Percent </th>\n   <th style=\"text-align:right;\"> Comma </th>\n   <th style=\"text-align:right;\"> Currency </th>\n   <th style=\"text-align:right;\"> Accounting </th>\n   <th style=\"text-align:right;\"> Scientific </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 6.8% </td>\n   <td style=\"text-align:right;\"> 1,000 </td>\n   <td style=\"text-align:right;\"> $1.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.0000e-04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5.0% </td>\n   <td style=\"text-align:right;\"> 10,000 </td>\n   <td style=\"text-align:right;\"> $1.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.0000e+05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5.0% </td>\n   <td style=\"text-align:right;\"> 100,000 </td>\n   <td style=\"text-align:right;\"> $1.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.0000e+11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4.0% </td>\n   <td style=\"text-align:right;\"> 1,000,000 </td>\n   <td style=\"text-align:right;\"> $1.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.0000e+00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9.0% </td>\n   <td style=\"text-align:right;\"> 10,000,000 </td>\n   <td style=\"text-align:right;\"> $1.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.0000e+00 </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n\n\n`library(formattable)` can be combined with any of the tools outlined in this document. All of the format functions can be used on individual vectors and passed to other table functions. \n\nIn this example, `currency()` is used with `kable()` to add a dollar sign and two decimals to price.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiamonds %>%\n\tmutate(price = currency(price)) %>%\n\thead() %>%\n\tkable(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> carat </th>\n   <th style=\"text-align:left;\"> cut </th>\n   <th style=\"text-align:left;\"> color </th>\n   <th style=\"text-align:left;\"> clarity </th>\n   <th style=\"text-align:right;\"> depth </th>\n   <th style=\"text-align:right;\"> table </th>\n   <th style=\"text-align:right;\"> price </th>\n   <th style=\"text-align:right;\"> x </th>\n   <th style=\"text-align:right;\"> y </th>\n   <th style=\"text-align:right;\"> z </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.23 </td>\n   <td style=\"text-align:left;\"> Ideal </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:left;\"> SI2 </td>\n   <td style=\"text-align:right;\"> 61.5 </td>\n   <td style=\"text-align:right;\"> 55 </td>\n   <td style=\"text-align:right;\"> $326.00 </td>\n   <td style=\"text-align:right;\"> 3.95 </td>\n   <td style=\"text-align:right;\"> 3.98 </td>\n   <td style=\"text-align:right;\"> 2.43 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.21 </td>\n   <td style=\"text-align:left;\"> Premium </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:left;\"> SI1 </td>\n   <td style=\"text-align:right;\"> 59.8 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> $326.00 </td>\n   <td style=\"text-align:right;\"> 3.89 </td>\n   <td style=\"text-align:right;\"> 3.84 </td>\n   <td style=\"text-align:right;\"> 2.31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.23 </td>\n   <td style=\"text-align:left;\"> Good </td>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:left;\"> VS1 </td>\n   <td style=\"text-align:right;\"> 56.9 </td>\n   <td style=\"text-align:right;\"> 65 </td>\n   <td style=\"text-align:right;\"> $327.00 </td>\n   <td style=\"text-align:right;\"> 4.05 </td>\n   <td style=\"text-align:right;\"> 4.07 </td>\n   <td style=\"text-align:right;\"> 2.31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.29 </td>\n   <td style=\"text-align:left;\"> Premium </td>\n   <td style=\"text-align:left;\"> I </td>\n   <td style=\"text-align:left;\"> VS2 </td>\n   <td style=\"text-align:right;\"> 62.4 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:right;\"> $334.00 </td>\n   <td style=\"text-align:right;\"> 4.20 </td>\n   <td style=\"text-align:right;\"> 4.23 </td>\n   <td style=\"text-align:right;\"> 2.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.31 </td>\n   <td style=\"text-align:left;\"> Good </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:left;\"> SI2 </td>\n   <td style=\"text-align:right;\"> 63.3 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:right;\"> $335.00 </td>\n   <td style=\"text-align:right;\"> 4.34 </td>\n   <td style=\"text-align:right;\"> 4.35 </td>\n   <td style=\"text-align:right;\"> 2.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.24 </td>\n   <td style=\"text-align:left;\"> Very Good </td>\n   <td style=\"text-align:left;\"> J </td>\n   <td style=\"text-align:left;\"> VVS2 </td>\n   <td style=\"text-align:right;\"> 62.8 </td>\n   <td style=\"text-align:right;\"> 57 </td>\n   <td style=\"text-align:right;\"> $336.00 </td>\n   <td style=\"text-align:right;\"> 3.94 </td>\n   <td style=\"text-align:right;\"> 3.96 </td>\n   <td style=\"text-align:right;\"> 2.48 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### formattable tables\n\n`library(formattable)` can add formatting to tables that blurs the line between table and plot. \n\n*Note:* `library(formattable)` creates objects of class `formattable` so it isn't necessary possible to combine all of the features of `library(formattable)` with the packages described elsewhere in this document. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(formattable)\n\nunemployment <- tibble(\n\tState = c(\"Alabama\", \"Alaska\", \"Arizona\", \"Arkansas\", \"California\"),\n  unemployment2000 = c(6.8, 5, 5, 4, 9),\n  unemployment2013 = c(6.4, 6.2, 5, 6, 6.5),\n  Change = c(-0.4, 1.2, 0, 2.0, -2.5)\n\t)\n\nsign_formatter <- formatter(\"span\", \n  style = x ~ style(color = ifelse(x > 0, \"green\", \n    ifelse(x < 0, \"red\", \"black\"))))\n\nformattable(unemployment, list(Change = sign_formatter))\n```\n\n::: {.cell-output-display}\n<table class=\"table table-condensed\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> State </th>\n   <th style=\"text-align:right;\"> unemployment2000 </th>\n   <th style=\"text-align:right;\"> unemployment2013 </th>\n   <th style=\"text-align:right;\"> Change </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> Alabama </td>\n   <td style=\"text-align:right;\"> 6.8 </td>\n   <td style=\"text-align:right;\"> 6.4 </td>\n   <td style=\"text-align:right;\"> <span style=\"color: red\">-0.4</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> Alaska </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 6.2 </td>\n   <td style=\"text-align:right;\"> <span style=\"color: green\">1.2</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> Arizona </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> <span style=\"color: black\">0.0</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> Arkansas </td>\n   <td style=\"text-align:right;\"> 4.0 </td>\n   <td style=\"text-align:right;\"> 6.0 </td>\n   <td style=\"text-align:right;\"> <span style=\"color: green\">2.0</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> California </td>\n   <td style=\"text-align:right;\"> 9.0 </td>\n   <td style=\"text-align:right;\"> 6.5 </td>\n   <td style=\"text-align:right;\"> <span style=\"color: red\">-2.5</span> </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n\n\nThe following example outlines advanced features:\n\n* `color_tile()` creates a colored tile under each observation of a variable\n* `formatter()` establishes rules for a custom format\n* `normalize_bar()` adds colored bars of varying size to each observation of a variable\n* `icontext()` adds glyphs to each observation of variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemployees <- tibble(Tenure = c(27, 8, 6, 5, 4),\n\t\t\t\t\t\t\t\t\t\tPerformance = c(\"B\", \"F\", \"A\", \"A\", \"C\"),\n\t\t\t\t\t\t\t\t\t\t`IT Training` = c(TRUE, FALSE, TRUE, TRUE, TRUE),\n\t\t\t\t\t\t\t\t\t\t`Accrued PTO` = c(98, 2, 8, 38, 6))\n\nformattable(employees, \n\tlist(Tenure = color_tile(\"white\", \"#1696d2\"),\n\t\t\t Performance = formatter(\"span\", \n\t\t\t \t\tstyle = x ~ ifelse(x == \"F\", style(color = \"red\", font.weight = \"bold\"), NA)),\n\t\t\t `IT Training` = formatter(\"span\", style = x ~ style(color = ifelse(x, \"green\", \"red\")),\n    \t\t\tx ~ icontext(ifelse(x, \"ok\", \"remove\"), ifelse(x, \"Yes\", \"No\"))),\n\t\t\t `Accrued PTO` = normalize_bar(\"#fdbf11\", 0.2)\n\t), caption = \"Employees\"\n)\n```\n\n::: {.cell-output-display}\n<table class=\"table table-condensed\">\n<caption>Employees</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Tenure </th>\n   <th style=\"text-align:right;\"> Performance </th>\n   <th style=\"text-align:right;\"> IT Training </th>\n   <th style=\"text-align:right;\"> Accrued PTO </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> <span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #1696d2\">27</span> </td>\n   <td style=\"text-align:right;\"> <span>B</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"color: green\">\n  <i class=\"glyphicon glyphicon-ok\"></i>\n  Yes\n</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: #fdbf11; width: 100.00%\">98</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> <span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d6ecf7\">8</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"color: red; font-weight: bold\">F</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"color: red\">\n  <i class=\"glyphicon glyphicon-remove\"></i>\n  No\n</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: #fdbf11; width: 20.00%\">2</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> <span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #eaf5fb\">6</span> </td>\n   <td style=\"text-align:right;\"> <span>A</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"color: green\">\n  <i class=\"glyphicon glyphicon-ok\"></i>\n  Yes\n</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: #fdbf11; width: 25.00%\">8</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> <span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #f4fafd\">5</span> </td>\n   <td style=\"text-align:right;\"> <span>A</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"color: green\">\n  <i class=\"glyphicon glyphicon-ok\"></i>\n  Yes\n</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: #fdbf11; width: 50.00%\">38</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> <span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff\">4</span> </td>\n   <td style=\"text-align:right;\"> <span>C</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"color: green\">\n  <i class=\"glyphicon glyphicon-ok\"></i>\n  Yes\n</span> </td>\n   <td style=\"text-align:right;\"> <span style=\"display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: #fdbf11; width: 23.33%\">6</span> </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n\n\n## library(stargazer)\n\n`library(stargazer)` is the best package for exporting \"untidy\", but well-formatted regression tables in .html, LaTeX, and ASCII. These tables can be included in R Markdown documents by adding the argument `results = \"asis\"` to the header of a \"code chunk\". \n\nThey can also be exported as .html code, LaTeX code, and formatted ASCII. \n\n`library(stargazer)` has an abundance of formatting options. [This vignette](https://cran.r-project.org/web/packages/stargazer/vignettes/stargazer.pdf) and [this cheatsheet](https://www.jakeruss.com/cheatsheets/stargazer/) outline most of what can be done with the package. This example shows how a little code can go a long way. Simply build as many models as desired, adjust some of the labels, and add a title. \n\n\n\n```{.r .cell-code}\nlibrary(stargazer)\n\nlinear1 <- lm(price ~ carat + x + y + z + depth, data = diamonds)\nlinear2 <- lm(price ~ carat + x + y + z, data = diamonds)\n\ndiamonds_indicator <- diamonds %>%\n  mutate(price_indicator = price > 5324)\n\nprobit1 <- glm(price_indicator ~ carat + x + y + z, data = diamonds_indicator, family = binomial(link = \"probit\"))\n\nstargazer(linear1, linear2, probit1, \n          type = \"html\",\n          title = \"Regression Results\",\n          align = TRUE, \n          dep.var.labels = c(\"Overall Prices\", \"High Prices\"),\n          covariate.labels = c(\"Carats\", \"X\", \"Y\", \"Z\", \"Cut\"),\n          no.space = TRUE,\n          digits = 2)\n```\n\n\n<table style=\"text-align:center\"><caption><strong>Regression Results</strong></caption>\n<tr><td colspan=\"4\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"></td><td colspan=\"3\"><em>Dependent variable:</em></td></tr>\n<tr><td></td><td colspan=\"3\" style=\"border-bottom: 1px solid black\"></td></tr>\n<tr><td style=\"text-align:left\"></td><td colspan=\"2\">Overall Prices</td><td>High Prices</td></tr>\n<tr><td style=\"text-align:left\"></td><td colspan=\"2\"><em>OLS</em></td><td><em>probit</em></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(1)</td><td>(2)</td><td>(3)</td></tr>\n<tr><td colspan=\"4\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Carats</td><td>10,615.50<sup>***</sup></td><td>10,233.91<sup>***</sup></td><td>-4.23<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(63.81)</td><td>(62.94)</td><td>(0.21)</td></tr>\n<tr><td style=\"text-align:left\">X</td><td>-1,369.67<sup>***</sup></td><td>-884.21<sup>***</sup></td><td>1.40<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(43.48)</td><td>(40.47)</td><td>(0.15)</td></tr>\n<tr><td style=\"text-align:left\">Y</td><td>97.60<sup>***</sup></td><td>166.04<sup>***</sup></td><td>1.45<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(25.76)</td><td>(25.86)</td><td>(0.15)</td></tr>\n<tr><td style=\"text-align:left\">Z</td><td>64.20</td><td>-576.20<sup>***</sup></td><td>1.96<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(44.75)</td><td>(39.28)</td><td>(0.13)</td></tr>\n<tr><td style=\"text-align:left\">Cut</td><td>-156.62<sup>***</sup></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(5.38)</td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Constant</td><td>12,196.69<sup>***</sup></td><td>1,921.17<sup>***</sup></td><td>-22.21<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(367.64)</td><td>(104.37)</td><td>(0.57)</td></tr>\n<tr><td colspan=\"4\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Observations</td><td>53,940</td><td>53,940</td><td>53,940</td></tr>\n<tr><td style=\"text-align:left\">R<sup>2</sup></td><td>0.86</td><td>0.85</td><td></td></tr>\n<tr><td style=\"text-align:left\">Adjusted R<sup>2</sup></td><td>0.86</td><td>0.85</td><td></td></tr>\n<tr><td style=\"text-align:left\">Log Likelihood</td><td></td><td></td><td>-10,315.28</td></tr>\n<tr><td style=\"text-align:left\">Akaike Inf. Crit.</td><td></td><td></td><td>20,640.56</td></tr>\n<tr><td style=\"text-align:left\">Residual Std. Error</td><td>1,512.17 (df = 53934)</td><td>1,524.01 (df = 53935)</td><td></td></tr>\n<tr><td style=\"text-align:left\">F Statistic</td><td>64,298.14<sup>***</sup> (df = 5; 53934)</td><td>78,920.42<sup>***</sup> (df = 4; 53935)</td><td></td></tr>\n<tr><td colspan=\"4\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"><em>Note:</em></td><td colspan=\"3\" style=\"text-align:right\"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>\n</table>\n\n\n##### Be sure to cite `library(stargazer)`:\n\n> Hlavac, Marek (2015). stargazer: Well-Formatted Regression and Summary Statistics\n> Tables. R package version 5.2. http://CRAN.R-project.org/package=stargazer\n\n## library(DT)\n\n`library(DT)` is an R interface for the DataTables library in JavaScript. This [vignette](https://rstudio.github.io/DT/) for the package outlines many ways output can be customized. \n\nThis example displays an augmented data frame used for a regression. That is, it displays the independent and dependent variables with fitted values, standard-errors of the fitted values, residuals, etc. \n\nThe example shows how columns can be renamed using `colnames = c(\"Price\" = \"price\")`. It's also possible to pass an entire vector of new columns like `colnames = c(\"Price\", \"Carat\", ...)`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DT)\nlibrary(broom)\n\nmodel1 <- lm(formula = mpg ~ wt, data = mtcars)\n\naugment(model1) %>%\n  mutate_at(vars(mpg:.std.resid), round, 2) %>%\n  datatable(colnames = c(\"Miles Per Gallon\" = \"mpg\", \"Weight\" = \"wt\"), options = list(pageLength = 5), style = \"bootstrap\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-eb775805af2d3495d0ed\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-eb775805af2d3495d0ed\">{\"x\":{\"style\":\"bootstrap\",\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\"],[\"Mazda RX4\",\"Mazda RX4 Wag\",\"Datsun 710\",\"Hornet 4 Drive\",\"Hornet Sportabout\",\"Valiant\",\"Duster 360\",\"Merc 240D\",\"Merc 230\",\"Merc 280\",\"Merc 280C\",\"Merc 450SE\",\"Merc 450SL\",\"Merc 450SLC\",\"Cadillac Fleetwood\",\"Lincoln Continental\",\"Chrysler Imperial\",\"Fiat 128\",\"Honda Civic\",\"Toyota Corolla\",\"Toyota Corona\",\"Dodge Challenger\",\"AMC Javelin\",\"Camaro Z28\",\"Pontiac Firebird\",\"Fiat X1-9\",\"Porsche 914-2\",\"Lotus Europa\",\"Ford Pantera L\",\"Ferrari Dino\",\"Maserati Bora\",\"Volvo 142E\"],[21,21,22.8,21.4,18.7,18.1,14.3,24.4,22.8,19.2,17.8,16.4,17.3,15.2,10.4,10.4,14.7,32.4,30.4,33.9,21.5,15.5,15.2,13.3,19.2,27.3,26,30.4,15.8,19.7,15,21.4],[2.62,2.88,2.32,3.21,3.44,3.46,3.57,3.19,3.15,3.44,3.44,4.07,3.73,3.78,5.25,5.42,5.34,2.2,1.61,1.83,2.46,3.52,3.44,3.84,3.85,1.94,2.14,1.51,3.17,2.77,3.57,2.78],[23.28,21.92,24.89,20.1,18.9,18.79,18.21,20.24,20.45,18.9,18.9,15.53,17.35,17.08,9.23,8.3,8.72,25.53,28.65,27.48,24.11,18.47,18.93,16.76,16.74,26.94,25.85,29.2,20.34,22.48,18.21,22.43],[-2.28,-0.92,-2.09,1.3,-0.2,-0.69,-3.91,4.16,2.35,0.3,-1.1,0.87,-0.05,-1.88,1.17,2.1,5.98,6.87,1.75,6.42,-2.61,-2.97,-3.73,-3.46,2.46,0.36,0.15,1.2,-4.54,-2.78,-3.21,-1.03],[0.04,0.04,0.06,0.03,0.03,0.03,0.04,0.03,0.03,0.03,0.03,0.06,0.04,0.04,0.17,0.2,0.18,0.07,0.12,0.1,0.05,0.03,0.03,0.04,0.04,0.09,0.07,0.13,0.03,0.04,0.04,0.04],[3.07,3.09,3.07,3.09,3.1,3.1,3.01,3,3.07,3.1,3.09,3.09,3.1,3.08,3.09,3.07,2.84,2.8,3.08,2.83,3.06,3.05,3.02,3.03,3.06,3.1,3.1,3.09,2.98,3.05,3.04,3.09],[0.01,0,0.02,0,0,0,0.03,0.03,0.01,0,0,0,0,0.01,0.02,0.07,0.53,0.19,0.02,0.26,0.02,0.02,0.03,0.03,0.02,0,0,0.01,0.04,0.02,0.02,0],[-0.77,-0.31,-0.71,0.43,-0.07,-0.23,-1.31,1.39,0.78,0.1,-0.37,0.29,-0.02,-0.63,0.42,0.77,2.17,2.33,0.61,2.22,-0.88,-0.99,-1.24,-1.16,0.83,0.12,0.05,0.42,-1.52,-0.93,-1.07,-0.34]],\"container\":\"<table class=\\\"table table-striped table-hover row-border order-column display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>.rownames<\\/th>\\n      <th>Miles Per Gallon<\\/th>\\n      <th>Weight<\\/th>\\n      <th>.fitted<\\/th>\\n      <th>.resid<\\/th>\\n      <th>.hat<\\/th>\\n      <th>.sigma<\\/th>\\n      <th>.cooksd<\\/th>\\n      <th>.std.resid<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":5,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8,9]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[5,10,25,50,100]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Export to Excel\n\nExporting to Microsoft Excel abandons many of the advantages, like reproducibility, automation and interactivity, of the other tools outlined in this document, but Excel is often a part of Urban Institute researchers' workflows.  \n\n### write_csv()\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/csv.png){width=300px}\n:::\n:::\n\n\nThe simplest option is to use `write_csv()` from `library(readr)` (loaded in `library(tidyverse)`) to create a .csv that can be opened in Microsoft Excel. Before writing to .csv, be sure to use `library(broom)` to put untidy information into data frames, `library(dplyr)` to select desired rows and columns, and `library(formattable)` to put individual columns into desired formats. \n\n#### Example code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndiamonds %>%\n\t# select and rename columns\n\tselect(Carat = carat, Price = price) %>%\n\t# filter to the first ten rows\n\tfilter(row_number() <= 10) %>%\n\t# save as .csv\n\twrite_csv(\"diamonds.csv\")\n```\n:::\n\n\n`write_excel_csv()` is a close alternative to `write_csv()` that includes a UTF-8 Byte order mark that indicates to Excel the csv is UTF-8 encoded. All other syntax should be identical. \n\n### library(writexl)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/excel.png){width=300px}\n:::\n:::\n\n\n`library(writexl)` is a new package that mimics the light-weight design of `library(readxl)`. It doesn't require JAVA or Microsoft Excel to create and write to a .xlsx document. The package is slim now but more development is expected in the near future. \n\n#### Example code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(writexl)\n\ndiamonds %>%\n\t# select and rename columns\n\tselect(Carat = carat, Price = price) %>%\n\t# filter to the first ten rows\n\tfilter(row_number() <= 10) %>%\n\t# save as .csv\n\twrite_xlsx(\"diamonds.xlsx\")\n```\n:::\n\n\n### library(openxlsx)\n\n`library(openxlsx)` ([CRAN](https://cran.r-project.org/web/packages/openxlsx/openxlsx.pdf), [GitHub](https://github.com/awalker89/openxlsx)) allows for the creation, writing, and styling of Microsoft Excel documents. It doesn't require JAVA, which is a huge improvement over its predecessors `library(xlsx)` and `library(XLConnect)`. \n\nFor Windows computers, `library(openxlsx)` will require a little extra setup which is outlined in this [GitHub README](https://github.com/awalker89/openxlsx)). Linux and Mac computers don't require any additional setup. \n\nSubmit `vignette(\"Introduction\", package = \"openxlsx\")` in R for a complete introduction to `library(openxlsx)`. \n\n#### Example code\n\nThe biggest advantage of `library(openxlsx)` is the ability to specify workbook, sheet number of name, starting row, and starting column. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(openxlsx)\n\nwriteData(wb, 1, df, startRow = 2, startCol = 2)\n\ndiamonds_subset <- diamonds %>%\n\t# select and rename columns\n\tselect(Carat = carat, Price = price) %>%\n\t# filter to the first ten rows\n\tfilter(row_number() <= 10) %>%\n\t# save as .csv\n\twrite_xlsx(\"diamonds.xlsx\")\n\nwriteData(wb = \"diamonds.xlsx\", \n\t\t\t\t\tsheet = \"price\", \n\t\t\t\t\tx = diamonds_subset, \n\t\t\t\t\tstartRow = 2, \n\t\t\t\t\tstartCol = 2)\n```\n:::\n\n\n`library(openxlsx)` also contains scores of options for controlling the destination format. `?writeData()` is good place to get started with formatting. \n\n## Tidy Data\n\nMost tools for building tables in R require tidy data frames or tibbles. [Tidy data](https://www.jstatsoft.org/article/view/v059i10) has three principles:\n\n1) Each variable forms a column\n2) Each observation forms a row\n3) Each type of observational unit forms a table\n\nNot all R output is tidy. For example, regression output isn't tidy by default: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(dist ~ speed, data = cars)\n\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = dist ~ speed, data = cars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.069  -9.525  -2.272   9.215  43.201 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -17.5791     6.7584  -2.601   0.0123 *  \nspeed         3.9324     0.4155   9.464 1.49e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15.38 on 48 degrees of freedom\nMultiple R-squared:  0.6511,\tAdjusted R-squared:  0.6438 \nF-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12\n```\n:::\n:::\n\n\nIt's easy to print the above output, as-is, to an R Markdown document or send it to a Microsoft Word file. But the above information isn't attractive and it can't be formatted. It also isn't machine readable!\n\nFortunately, R has a suite of packages that make easy tidying data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\ntidy(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2  5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)   -17.6      6.76      -2.60 1.23e- 2\n2 speed           3.93     0.416      9.46 1.49e-12\n```\n:::\n:::\n\n\nNow the regression is in a tidy format with each variable as a column, each observation as a row, and the observational unit is coefficients. It is easy to put data into tables once data are \"tidy\".\n\n### library(broom)\n\n`library(broom)` is useful for converting statistical analysis objects from R into data frames.\n\nRegressions in R are stored in clunky hierarchical data structures. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(dist~speed, data = cars)\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = dist ~ speed, data = cars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.069  -9.525  -2.272   9.215  43.201 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -17.5791     6.7584  -2.601   0.0123 *  \nspeed         3.9324     0.4155   9.464 1.49e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15.38 on 48 degrees of freedom\nMultiple R-squared:  0.6511,\tAdjusted R-squared:  0.6438 \nF-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12\n```\n:::\n:::\n\n\n#### glance()\n\n`glance()` returns a tidy data frame with one observation for each model. Each column gives a model summary: either a measure of model quality or complexity, or a combination of the two.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nglance(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1  12\n  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>    <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.651         0.644  15.4      89.6 1.49e-12     1  -207.  419.  425.\n#  with 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n:::\n:::\n\n\n#### tidy()\n\n`tidy()` returns a tidy data frame with one observation for each coefficient in a model. Each column gives information about the estimate or its variability.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2  5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)   -17.6      6.76      -2.60 1.23e- 2\n2 speed           3.93     0.416      9.46 1.49e-12\n```\n:::\n:::\n\n\n#### augment()\n\n`augment()` returns a tidy data frame with one observation for each observation in the input data set. \n\n\n::: {.cell}\n\n```{.r .cell-code}\naugment(model1) %>%\n\ttop_n(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5  8\n   dist speed .fitted .resid   .hat .sigma .cooksd .std.resid\n  <dbl> <dbl>   <dbl>  <dbl>  <dbl>  <dbl>   <dbl>      <dbl>\n1    60    14    37.5   22.5 0.0214   15.2  0.0240       1.48\n2    80    14    37.5   42.5 0.0214   14.2  0.0856       2.80\n3    76    18    53.2   22.8 0.0249   15.2  0.0288       1.50\n4    84    18    53.2   30.8 0.0249   14.9  0.0526       2.03\n5   120    24    76.8   43.2 0.0740   14.1  0.340        2.92\n```\n:::\n:::\n\n\n### library(dplyr)\n\n`library(dplyr)` is a powerful tool for data manipulation. The following \"verbs\" control the most common data manipulations:\n\n1) `select()`: select columns from a data frame\n2) `filter()`: filter rows in a data frame based on a condition or conditions\n3) `arrange()`: change the order of observations in a data frame\n4) `mutate()`: create or alter variables in a data frame\n5) `rename()`: change the name of a variable in a data frame\n6) `summarize()`: summarize values in a data frame into one row or multiple rows for grouped observations\n7) `group_by()`: group observations based on the levels of a variable or levels of variables\n\nThese verbs are useful for changing data frames before converting them into publishable tables.\n\n## Putting it all together\n\nThe code examples above highlight the marginal changes of different functions or arguments. The examples do not put all of the tools together into publication-ready tables. This section will be a repository for tables made for Urban Institute publications in R. \n\n## Appendix\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-apple-darwin17.0 (64-bit)\nRunning under: macOS Big Sur 10.16\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] broom_0.7.10      DT_0.20           stargazer_5.2.3   kableExtra_1.3.4 \n [5] formattable_0.2.1 knitr_1.36        forcats_0.5.1     stringr_1.4.0    \n [9] dplyr_1.0.8       purrr_0.3.4       readr_2.1.1       tidyr_1.2.0      \n[13] tibble_3.1.6      ggplot2_3.3.5     tidyverse_1.3.1  \n\nloaded via a namespace (and not attached):\n [1] svglite_2.1.0     lubridate_1.8.0   assertthat_0.2.1  digest_0.6.29    \n [5] utf8_1.2.2        R6_2.5.1          cellranger_1.1.0  backports_1.4.0  \n [9] reprex_2.0.1      evaluate_0.14     httr_1.4.2        highr_0.9        \n[13] pillar_1.7.0      rlang_1.0.2       readxl_1.4.0.9000 rstudioapi_0.13  \n[17] jquerylib_0.1.4   rmarkdown_2.11    webshot_0.5.3     htmlwidgets_1.5.4\n[21] munsell_0.5.0     compiler_4.1.2    modelr_0.1.8      xfun_0.28        \n[25] pkgconfig_2.0.3   systemfonts_1.0.3 htmltools_0.5.2   tidyselect_1.1.2 \n[29] fansi_1.0.3       viridisLite_0.4.0 crayon_1.5.1      tzdb_0.2.0       \n[33] dbplyr_2.1.1      withr_2.4.3       grid_4.1.2        jsonlite_1.7.2   \n[37] gtable_0.3.0      lifecycle_1.0.1   DBI_1.1.1         magrittr_2.0.3   \n[41] scales_1.1.1      cli_3.2.0         stringi_1.7.6     fs_1.5.1         \n[45] xml2_1.3.3        ellipsis_0.3.2    generics_0.1.2    vctrs_0.4.1      \n[49] tools_4.1.2       glue_1.6.2        crosstalk_1.2.0   hms_1.1.1        \n[53] fastmap_1.1.0     yaml_2.2.1        colorspace_2.0-2  rvest_1.0.2      \n[57] haven_2.4.3      \n```\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.20/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-bootstrap-1.11.3/css/dataTables.bootstrap.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-bootstrap-1.11.3/css/dataTables.bootstrap.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-bootstrap-1.11.3/js/jquery.dataTables.min.js\"></script>\n<script src=\"../site_libs/dt-core-bootstrap-1.11.3/js/dataTables.bootstrap.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}